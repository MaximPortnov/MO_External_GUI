# specs/commands.md

## üß© –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–Ω–∞–±–æ—Ä –∫–æ–º–∞–Ω–¥**, –∫–æ—Ç–æ—Ä—ã–µ GUI –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ Lua-–Ω–∞–¥—Å—Ç—Ä–æ–π–∫—É MyOffice —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `command.log`.  
–ö–æ–º–∞–Ω–¥—ã –∑–∞–¥–∞—é—Ç, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º.

---

## ‚öôÔ∏è –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- –ö–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ **—Ñ–æ—Ä–º–∞—Ç–µ JSON**, –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞.  
- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è **–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ** ‚Äî –æ—Ç GUI –∫ Lua.  
- –ê—Ä–≥—É–º–µ–Ω—Ç—ã (`args`) —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–∞ `{}`.  
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –∑–∞–ø–∏—Å–∏** (FIFO).  
- –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ GUI **–¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `EXIT`**.

---

## üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥—ã

```json
{"id": 1, "cmd": "SET_CELL_TEXT", "args": {"sheet": 0, "addr": "A1", "text": "–ü—Ä–∏–≤–µ—Ç"}}
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|---------------|-----------|
| `id` | number | –¥–∞ | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–æ–º–∞–Ω–¥—ã (–¥–ª—è –ª–æ–≥–æ–≤ –∏ –æ—Ç–ª–∞–¥–∫–∏) |
| `cmd` | string | –¥–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã |
| `args` | object | –¥–∞ | –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥—ã; –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω—ã ‚Äî –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è `{}` |

---

## üìò –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∫–æ–º–∞–Ω–¥

| –ö–æ–º–∞–Ω–¥–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ê—Ä–≥—É–º–µ–Ω—Ç—ã |
|----------|-------------|-----------|
| **SAVE_AS** | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º | `path` (string) ‚Äî –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É |
| **SAVE** | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç | ‚Äî |
| **ADD_SHEET** | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ª–∏—Å—Ç | `name?` (string), `rows?` (int), `cols?` (int) |
| **RENAME_SHEET** | –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ª–∏—Å—Ç | `sheet` (number/string), `name` (string) |
| **SET_CELL_TEXT** | –ó–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ —è—á–µ–π–∫—É | `sheet` (number/string), `addr` (string), `text` (string) |
| **SET_CELL_NUMBER** | –ó–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–æ –≤ —è—á–µ–π–∫—É | `sheet` (number/string), `addr` (string), `number` (number) |
| **SET_CELL_FORMULA** | –ó–∞–ø–∏—Å–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É –≤ —è—á–µ–π–∫—É | `sheet` (number/string), `addr` (string), `formula` (string) |
| **SET_RANGE_TEXT** | –ó–∞–ø–∏—Å–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π | `sheet` (number/string), `range` (string), `values` (string[][]) |
| **FIND_REPLACE** | –ù–∞–π—Ç–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç | `sheet` (number/string), `range?` (string), `find` (string), `replace` (string) |
| **CREATE_FILTERS_RANGE** | –°–æ–∑–¥–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω | `sheet` (number/string), `range` (object ‚Äî `{row, col, rows, cols}`) |
| **SET_FILTERS** | –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã | `sheet` (number/string), `filters` (array –æ–±—ä–µ–∫—Ç–æ–≤ `{col, values?, cond?}`) |
| **CLEAR_FILTERS** | –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã | `sheet` (number/string) |
| **EXIT** | –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É GUI –∏ –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏ | ‚Äî |

---

## üß± –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

### –î–æ–±–∞–≤–∏—Ç—å –ª–∏—Å—Ç

```json
{"id": 1, "cmd": "ADD_SHEET", "args": {"name": "Demo"}}
```

### –ó–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ —è—á–µ–π–∫—É

```json
{"id": 2, "cmd": "SET_CELL_TEXT", "args": {"sheet": 0, "addr": "A1", "text": "–ü—Ä–∏–≤–µ—Ç"}}
```

### –ù–∞–π—Ç–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç

```json
{"id": 3, "cmd": "FIND_REPLACE", "args": {"sheet": 0, "find": "TODO", "replace": ""}}
```

### –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥ –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º

```json
{"id": 4, "cmd": "SAVE_AS", "args": {"path": "C:/temp/report.xlsx"}}
```

### –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É GUI

```json
{"id": 999, "cmd": "EXIT", "args": {}}
```

---

## üß© –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –∫–æ–º–∞–Ω–¥

–≠—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å:

- –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ `cmd`, –Ω–µ –Ω–∞—Ä—É—à–∞—é—â–∏–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å;
- –æ–±–Ω–æ–≤–ª—è—è `specs/commands.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤;
- —Å–æ—Ö—Ä–∞–Ω—è—è –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `{ "id": <int>, "cmd": "<NAME>", "args": { ... } }`.

---

## üìö –ì–¥–µ —á–∏—Ç–∞—Ç—å –¥–∞–ª—å—à–µ

- **[PROTOCOL.md](../PROTOCOL.md)** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ `command.log` –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.  
- **[ARCHITECTURE.md](../ARCHITECTURE.md)** ‚Äî –æ–±—â–∞—è —Å—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã GUI ‚Üî Lua.  
